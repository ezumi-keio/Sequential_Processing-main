# Efficient and Effective Blind JPEG Image Improvement with Sequential Feature Processing

:rocket: This file contains the source code used in the proposed method of the proposed paper named "Efficient and Effective Blind JPEG Image Improvement with Sequential Feature Processing." The source codes are currently being prepared for public release, and we are providing a preliminary version as supplementary material (as of Aug. 2024). The source codes in this file are based on based on **PowerQE** (https://github.com/ryanxingql/powerqe).

:rocket: Clone: **PowerQE** adopts [PythonUtils](https://github.com/ryanxingql/pythonutils) as a sub-module. 


:e-mail: Feel free to contact: `ezumi@tkhm.elec.keio.ac.jp`.



## 1. Dependency
**Being Prepared**

## 2. Image Data
**Being Prepared**
### (Dataset for training)
We unify the training dataset of each method on that used for CRESNet [1] (Synthesized Dataset). The dataset is generated by cropping sub-images whose sizes are 512 × 512 from images in DIV2K [2] and Flickr2K [3] and compressing with a random QF between 0 and 100 for each image.

### (Dataset for test)
We use three datasets for the evaluation of each method: LIVE1 [4], BSDS500 [5], and Urban100 [6].

[2] E. Agustsson and R. Timofte, ‘‘Ntire 2017 challenge on single image superresolution: Dataset and study,’’ 2017 IEEE Conference on ComputerVision and Pattern Recognition Workshops (CVPRW), pp.1122–1131, 2017.
[3] R. Timofte, E. Agustsson, L.V. Gool, M.-H. Yang, L. Zhang, B. Lim, S. Son, H. Kim, S. Nah, K.M. Lee, X. Wang, Y. Tian, K. Yu, Y. Zhang, S. Wu, C. Dong, L. Lin, Y. Qiao, C.C. Loy, W. Bae, J.J. Yoo, Y. Han, J.C. Ye, J.-S. Choi, M. Kim, Y. Fan, J. Yu, W. Han, D. Liu, H. Yu, Z. Wang, H. Shi, X. Wang, T.S. Huang, Y. Chen, K. Zhang, W. Zuo, Z. Tang, L. Luo, S. Li, M. Fu, L. Cao, W. Heng, G. Bui, T. Le, Y. Duan, D. Tao, R. Wang, X. Lin, J. Pang, J. Xu, Y. Zhao, X. Xu, J. shanPan, D. Sun, Y. Zhang, X. Song, Y. Dai, X. Qin, X.-P. Huynh, T. Guo, H.S. Mousavi, T.H. Vu, V. Monga, C. Cruz, K.O. Egiazarian, V. Katkovnik, R. Mehta, A.K. Jain, A. Agarwalla, C. Praveen, R. Zhou, H. Wen, C. Zhu, Z. Xia, Z. Wang, and Q. Guo, ‘‘Ntire 2017 challenge on single image super-resolution: Methods and results,’’ 2017 IEEE Conference on Computer Vision and Pattern Recognition Workshops (CVPRW), pp.1110–1121, 2017.
[4] H.R. Sheikh, M.F. Sabir, and A.C. Bovik, ‘‘A statistical evaluation of recent full reference image quality assessment algorithms,’’ IEEE Transactions on Image Processing, vol.15, no.11, pp.3440–3451, 2006.
[5] P. Arbeláez, M. Maire, C. Fowlkes, and J. Malik, ‘‘Contour detection and hierarchical image segmentation,’’ IEEE Transactions on Pattern Analysis and Machine Intelligence, vol.33, no.5, pp.898–916, 2011.
[6] J.-B. Huang, A. Singh, and N. Ahuja, ‘‘Single image super-resolution from transformed self-exemplars,’’ 2015 IEEE Conference on Computer Vision and Pattern Recognition (CVPR), pp.5197–5206, 2015.

### Compress

We take dataset for training (random QFs) and JPEG (QF=10) as examples.
Add command-line arguments in order of 
1. Dataset name
2. Folder name which contains raw images without compression
3. Target folder name
4. Quality factor (0-100 for specified QF, and -1 for random QFs)

```bash
# JPEG QF=10
python main_compress_jpeg.py div2k raw jpeg 10

# JPEG, random QFs
python main_compress_jpeg.py div2k raw jpeg -1
```


## 3. Train
**Being Prepared**
Edit opts/sequential_fortrain.yml to change settings.

```bash
python train.py -opt opts/sequential_fortrain.yml -case synthesized_jpeg
```

## 4. Test
**Being Prepared**
Edit opts/sequential_fortest.yml to change settings.
You can test images with any QF by preparing compressed images and setting the directory to "lq_path".

```bash
python test.py -opt opts/sequential_fortest.yml -case live1_jpeg_test_qf10
```

## 5. Result
**Being Prepared**


## 6. License

We adopt Apache License v2.0.


